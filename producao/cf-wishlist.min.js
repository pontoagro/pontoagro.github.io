!function(){try{let o={init:function(){o.getInfo(),$(document.body).is(".product")&&(o.addProdutcInList(),o.removeProductInList()),o.addShelfProductInList(),o.removeShelfProductInList()},dataUserOrderForm:null,dataUserParsed:null,getInfo:()=>{var e;localStorage&&localStorage.CF_listUser&&localStorage.CF_listUser.length?(e=JSON.parse(localStorage.CF_listUser),(o.dataUserParsed=e).useritems.length?e.useritems.length&&($(document.body).is(".product")&&o.setDataInFrontProduct(),$(document.body).is(".wishlist")&&o.showProductsInFavorites(),o.showTotalItensInList(),o.showProductInShowAlreadyAdd(),$(".shelf-item__wishlist button").removeClass("list-loaded")):o.emptyListInUserPage()):vtexjs.checkout.getOrderForm().done(function(e){e.clientProfileData&&null!=e.clientProfileData.email?o.getInfoByOrderForm(e):$(".shelf-item__wishlist button").removeClass("list-loaded")})},getInfoByOrderForm:t=>{var e=t.clientProfileData.email;$.ajax({type:"GET",url:`/api/dataentities/favoritos/search?_schema=cf-body&email=${e}`,dataType:"json",contentType:"application/json",headers:{Accept:"application/vnd.vtex.ds.v10+json","Content-Type":"application/json; charset=utf-8"}}).done(function(e){e.length?(console.log("Usuario com lista"),localStorage.setItem("CF_listUser",JSON.stringify(e[0])),o.dataUserParsed=e[0],$(document.body).is(".product")&&o.setDataInFrontProduct(),$(document.body).is(".wishlist")&&o.showProductsInFavorites(),o.showTotalItensInList(),o.showProductInShowAlreadyAdd(),$(".shelf-item__wishlist button").removeClass("list-loaded")):(console.log("Primeira vez no wishlist."),o.registerEmailInMDFirstTime(t))})},registerEmailInMDFirstTime:e=>{let t={email:e.clientProfileData.email,useritems:[]};$.ajax({type:"POST",url:"/api/dataentities/favoritos/documents?_schema=cf-body",dataType:"json",contentType:"application/json",headers:{Accept:"application/vnd.vtex.ds.v10+json","Content-Type":"application/json; charset=utf-8"},data:JSON.stringify(t)}).done(function(e){t.id=e.DocumentId,localStorage.setItem("CF_listUser",JSON.stringify(t))})},setDataInFrontProduct:()=>{let t=!1;o.dataUserParsed.useritems.forEach(e=>{e==skuJson.productId&&(t=!0)}),t&&($(".cf-product-wishlist--button.add").addClass("hide"),$(".cf-product-wishlist--button.remove").removeClass("hide"))},showProductsInFavorites:()=>{let t=$(".cf-wishlist.render"),a=null;o.dataUserParsed.useritems.forEach((e,t,s)=>{a=0==t?`fq=productId:${e}`:`${a}&fq=productId:${e}`});var e=`/buscapagina?${a}&PS=50&sl=29ecb99f-4d8f-46a5-9a88-649af471e1f4&cc=1&sm=0`;$.ajax({type:"GET",url:e}).done(function(e){t.append(e),o.removeShelfProductInListUser(),$(".cf-wishlist.loader").hide()})},showProductInShowAlreadyAdd:function(){$(".shelf-item__wishlist.shelf-default").each(function(){let e=$(this),t=e.closest(".cf-storefront.main").attr("data-sku");o.dataUserParsed.useritems.find(function(e){return e==t})&&(e.find(".shelf-wishlist--button.shelf.add").addClass("hide"),e.find(".shelf-wishlist--button.shelf.remove").removeClass("hide"))})},addProdutcInList:function(){$(document).one("click",".cf-product-wishlist--button.add",function(e){if(null==o.dataUserParsed)o.verifyIfUserIsNull();else{let e=o.dataUserParsed.useritems;null==e?e=[skuJson.productId]:e.push(skuJson.productId);var t={id:o.dataUserParsed.id,email:o.dataUserParsed.email,useritems:e};o.sendPatchToMD(t)}})},addShelfProductInList:function(){$(document).one("click",".shelf-wishlist--button.shelf.add",function(e){if(null==o.dataUserParsed)o.verifyIfUserIsNull();else{var t=$(this).closest(".cf-storefront.main").attr("data-sku"),t=parseInt(t);let e=o.dataUserParsed.useritems;null==e?e=[t]:e.push(t);t={id:o.dataUserParsed.id,email:o.dataUserParsed.email,useritems:e};o.sendPatchToMD(t)}})},removeProductInList:function(){$(document).one("click",".cf-product-wishlist--button.remove",function(e){let t=o.dataUserParsed.useritems.filter(function(e){return e!==skuJson.productId});t.length||(t=[]);var s={id:o.dataUserParsed.id,email:o.dataUserParsed.email,useritems:t};o.sendPatchToMD(s)})},removeShelfProductInList:function(){$(document).one("click",".shelf-wishlist--button.shelf.remove",function(e){let t=$(this).closest(".cf-storefront.main").attr("data-sku");t=parseInt(t);let s=o.dataUserParsed.useritems.filter(function(e){return e!==t});s.length||(s=[]);var a={id:o.dataUserParsed.id,email:o.dataUserParsed.email,useritems:s};o.sendPatchToMD(a)})},removeShelfProductInListUser:()=>{$(document).one("click",".shelf-wishlist--button.shelf-user.remove",function(e){let t=$(this).closest(".cf-storefront.main").attr("data-sku");t=parseInt(t);let s=o.dataUserParsed.useritems.filter(function(e){return e!==t});s.length||(s=[]);var a={id:o.dataUserParsed.id,email:o.dataUserParsed.email,useritems:s};o.sendPatchToMD(a)})},showTotalItensInList:()=>{let e=$(".cf-header--favorites--total"),t=o.dataUserParsed.useritems.length||0;e.text(t)},verifyIfUserIsNull:()=>{if(null==o.dataUserParsed)return vtexid.start(),void o.verifyVtexId()},emptyListInUserPage:()=>{$(".shelf-item__wishlist button").removeClass("list-loaded"),$(document.body).is(".wishlist")&&($(".cf-wishlist.loader").addClass("hide"),$(".cf-wishlist.empty").removeClass("hide"))},sendPatchToMD:t=>{var e=o.dataUserParsed.id;$.ajax({type:"PATCH",url:`/api/dataentities/favoritos/documents/${e}?_schema=cf-body`,dataType:"json",contentType:"application/json",headers:{"Content-Type":"application/json",Accept:"application/vnd.vtex.ds.v10+json"},data:JSON.stringify(t)}).done(function(e){localStorage.setItem("CF_listUser",JSON.stringify(t)),swal({title:"Lista de desejos atualizada!",icon:"success"}).then(()=>{location.reload()})})},reloadClickFunctionsIfCloseModal:function(){$("#vtexIdContainer.ng-scope").find(".vtexIdUI-page.ng-scope.vtexIdUI-confirm-email .close.vtexIdUI-close, .vtexIdUI-page.ng-scope.vtexIdUI-page-active .close.vtexIdUI-close, .vtexIdUI-page.ng-scope.vtexIdUI-no-permission .close.vtexIdUI-close, .vtexIdUI-page.ng-scope.vtexIdUI-multiple-link-account .close.vtexIdUI-close, .vtexIdUI-page.ng-scope.vtexIdUI-change-pswd .close.vtexIdUI-close").on("click",function(){o.addProdutcInList(),o.removeProductInList(),o.addShelfProductInList(),o.removeShelfProductInList()})},verifyVtexId:function(){let e=setInterval(function(){$("#vtexIdContainer.ng-scope").length&&(clearInterval(e),o.reloadClickFunctionsIfCloseModal())},50)}};$(document).ready(o.init)}catch(e){console.log("Erro na inst√¢ncia do [Wishlist]: ",e)}}();